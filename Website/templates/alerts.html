{% extends 'base.html' %}
{% load static %}

{% block title %}Alerts - GE Tools{% endblock %}

{% block extra_css %}
<!-- Alert page styles - loaded in head to prevent FOUC (Flash of Unstyled Content) -->
<!-- What: CSS files for styling the alerts page components -->
<!-- Why: Loading in the head ensures styles are applied before content renders, preventing the icon from flashing full-screen -->
<!-- How: Using Django's static template tag to load CSS files in order of dependency -->
<link rel="stylesheet" href="{% static 'css/alerts-variables.css' %}">
<link rel="stylesheet" href="{% static 'css/alerts-help-modal.css' %}">
<link rel="stylesheet" href="{% static 'css/alerts-components.css' %}">
<link rel="stylesheet" href="{% static 'css/alerts-form.css' %}">
<link rel="stylesheet" href="{% static 'css/alerts-modals.css' %}">
<link rel="stylesheet" href="{% static 'css/alerts-item-collections.css' %}">
<link rel="stylesheet" href="{% static 'css/alerts-responsive.css' %}">
<!-- Group selector styles (shared with alert_detail.html) -->
<link rel="stylesheet" href="{% static 'css/group-selector.css' %}">

{% endblock %}

{% block content %}

<style>

.btn-buy-limit {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 8px;
    font-size: 11px;
    font-weight: 500;
    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s ease;
    position: relative;
}

.btn-buy-limit:hover:not(:disabled) {
    background: linear-gradient(135deg, #34D399 0%, #10B981 100%);
    box-shadow: 0 2px 6px rgba(16, 185, 129, 0.3);
    transform: translateY(-1px);
}

</style>







<div class="page-header">
    <div class="page-header-icon">
        <svg fill="currentColor" viewBox="0 0 20 20">
            <path
                d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" />
        </svg>
    </div>
    <div class="page-header-text">
        <h1>Alerts</h1>
        <p>Set up price alerts and get notified when items hit your targets. Click on individual alerts to get more
            details.</p>
    </div>
</div>

<div class="alert-tabs">
    <button class="tab-btn active" data-tab="my-alerts">My Alerts</button>
    <button class="tab-btn" data-tab="create-alert">Create Alert</button>
</div>

<div class="tab-content">
    <div id="my-alerts" class="tab-pane active">
        <div id="triggered-notifications">
            {% for message in messages %}
            <div class="triggered-notification status-notification">
                {{ message }}
                <button class="dismiss-btn" onclick="dismissStatusNotification(this)">&times;</button>
            </div>
            {% endfor %}
        </div>
        <div class="alert-actions-wrapper">
            <div class="alert-actions">
                <div class="alert-actions-left">
                    <div class="custom-dropdown-wrapper">
                        <button type="button" class="btn-dropdown btn-actions" id="actionsDropdownBtn">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            <span class="btn-text">Actions</span>
                        </button>
                        <div class="custom-dropdown-menu" id="actionsDropdownMenu">
                            <div class="custom-dropdown-header">Actions</div>
                            <div class="custom-dropdown-item" data-action="delete">
                                <span>Delete</span>
                            </div>
                            <div class="custom-dropdown-item" data-action="group">
                                <span>Add to Group</span>
                            </div>
                        </div>
                    </div>
                    <div class="alert-search-wrapper">
                        <svg class="alert-search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <input type="text" class="alert-search-input" id="alertSearchInput"
                            placeholder="Search alerts..." autocomplete="off">
                        <button type="button" class="alert-search-clear" id="alertSearchClear"
                            title="Clear search">Ã—</button>
                    </div>
                </div>
                <div class="alert-actions-right" id="active-filters">
                    <div class="alert-actions-controls">
                        <div class="sort-controls">
                            <div class="sort-indicator-wrapper" id="sortIndicatorWrapper">
                                <div class="sort-indicator" id="sortIndicator">
                                    <span class="sort-indicator-label">Sorted by:</span>
                                    <span class="sort-indicator-value" id="sortIndicatorValue"></span>
                                    <span class="sort-indicator-arrow" id="sortIndicatorArrow"
                                        title="Toggle sort order">â†“</span>
                                    <span class="sort-indicator-clear" id="sortIndicatorClear"
                                        title="Clear sort">Ã—</span>
                                </div>
                            </div>
                            <div class="custom-dropdown-wrapper">
                                <button type="button" class="btn-dropdown btn-sort" id="sortDropdownBtn">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12" />
                                    </svg>
                                    <span class="btn-text">Sort</span>
                                </button>
                                <div class="custom-dropdown-menu" id="sortDropdownMenu">
                                    <div class="custom-dropdown-header">Sort by</div>
                                    <div class="custom-dropdown-item" data-sort="alphabetically">
                                        <span>Alphabetically</span>
                                        <span class="sort-check">âœ“</span>
                                    </div>
                                    <div class="custom-dropdown-item" data-sort="lastTriggered">
                                        <span>Last Triggered Time</span>
                                        <span class="sort-check">âœ“</span>
                                    </div>
                                    <div class="custom-dropdown-item" data-sort="alertType">
                                        <span>Alert Type</span>
                                        <span class="sort-check">âœ“</span>
                                    </div>
                                    <div class="custom-dropdown-item" data-sort="thresholdDistance">
                                        <span>Threshold Distance</span>
                                        <span class="sort-check">âœ“</span>
                                    </div>
                                    <div class="custom-dropdown-item" data-sort="createdDate">
                                        <span>Created Date</span>
                                        <span class="sort-check">âœ“</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="custom-dropdown-wrapper">
                            <button type="button" class="btn-dropdown btn-filter" id="filterDropdownBtn">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                                </svg>
                                <span class="btn-text">Filters</span>
                                <span class="filter-badge" id="filterBadge" style="display: none;">0</span>
                            </button>
                            <div class="custom-dropdown-menu" id="filterDropdownMenu">
                                <div class="custom-dropdown-header">Filter by</div>
                                <div class="custom-dropdown-item" data-filter="triggered">
                                    <span>Triggered</span>
                                    <span class="filter-check">âœ“</span>
                                    <span class="filter-clear" title="Clear filter">Ã—</span>
                                </div>
                                <div class="custom-dropdown-item" data-filter="notTriggered">
                                    <span>Not Triggered</span>
                                    <span class="filter-check">âœ“</span>
                                    <span class="filter-clear" title="Clear filter">Ã—</span>
                                </div>
                                <div class="custom-dropdown-item" data-filter="priceRange">
                                    <span>Price</span>
                                    <span class="filter-check">âœ“</span>
                                    <span class="filter-clear" title="Clear filter">Ã—</span>
                                </div>
                                <div class="custom-dropdown-item" data-filter="myGroups">
                                    <span>My Groups</span>
                                    <span class="filter-check">âœ“</span>
                                    <span class="filter-clear" title="Clear filter">Ã—</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Mobile sort indicator row (shown on smaller screens) -->
            <div class="sort-indicator-mobile-row" id="sortIndicatorMobileRow">
                <div class="sort-indicator" id="sortIndicatorMobile">
                    <span class="sort-indicator-label">Sorted by:</span>
                    <span class="sort-indicator-value" id="sortIndicatorValueMobile"></span>
                    <span class="sort-indicator-arrow" id="sortIndicatorArrowMobile" title="Toggle sort order">â†“</span>
                    <span class="sort-indicator-clear" id="sortIndicatorClearMobile" title="Clear sort">Ã—</span>
                </div>
            </div>
            <div class="alert-indicators">
                <div class="filter-tags"></div>
                <div class="sort-tag-holder"></div>
            </div>
        </div>
        <div id="alerts-list-container">
            <div class="loading-container">
                <div class="spinner-border" role="status" style="width: 48px; height: 48px; color: var(--primary);"></div>
                <span class="loading-text">Loading</span>
            </div>
        </div>
    </div>
    <div id="create-alert" class="tab-pane" style="display: none;">
        <form method="POST" action="{% url 'create_alert' %}" class="create-alert-form">
            {% csrf_token %}

            <div class="form-group">
                <label for="alert-type">Alert Type</label>
                <!-- What: Dropdown to select the type of alert to create
                     Why: Different alert types have different configuration options and behaviors
                     How: Default is "threshold" as it's the most commonly used alert type -->
                <select name="type" id="alert-type" required onchange="handleAlertTypeChange()" tabindex="1">
                    <option value="spread">Spread</option>
                    <option value="spike">Spike</option>
                    <option value="sustained">Sustained Move</option>
                    <option value="threshold" selected>Threshold</option>
                    <option value="collective_move">Collective Move</option>
                </select>
                <button type="button" class="alert-help-btn" onclick="openAlertHelpModal()" tabindex="2">
                    <svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16">
                        <path fill-rule="evenodd"
                            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                            clip-rule="evenodd" />
                    </svg>
                    How do alerts work?
                </button>
            </div>

            <div class="form-group">
                <label for="alert-name-type">Alert Name</label>
                <select name="alert_name_type" id="alert-name-type" onchange="handleAlertNameTypeChange()" tabindex="3">
                    <option value="default" selected>Default name</option>
                    <option value="custom">Custom</option>
                </select>
                <small class="form-hint">Choose a name for your alert</small>
            </div>

            <div class="form-group" id="custom-name-group" style="display: none;">
                <label for="alert-custom-name">Custom Name</label>
                <input type="text" name="alert_name" id="alert-custom-name" maxlength="255"
                    placeholder="Enter alert name..." tabindex="4">
                <small class="form-hint">Enter a custom name for this alert</small>
            </div>

            <!-- Group Selection -->
            <!-- What: Dropdown to select which group to assign to the new alert -->
            <!-- Why: Users can organize alerts into groups for easier management -->
            <!-- How: Dropdown populated from user's groups with "+" button to create new -->
            <div class="form-group">
                <label for="alert-group">Group</label>
                <div class="group-selector-wrapper">
                    <select name="group_id" id="alert-group" tabindex="5">
                        <option value="">No Group</option>
                    </select>
                    <button type="button" class="btn-add-group" onclick="openNewGroupModal()" title="Create new group" tabindex="6">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 4v16m8-8H4"/>
                        </svg>
                    </button>
                </div>
                <small class="form-hint">Group your alerts. Click + to create a new group</small>
            </div>

            <!-- Spike-specific Apply To selector -->
            <!-- What: Dropdown to choose scope for spike alerts (all items or specific items) -->
            <!-- Why: Users may want to monitor spike on all items or a curated list of specific items -->
            <!-- How: Changes form visibility and sets appropriate hidden fields -->
            <!-- Note: "Specific Item(s)" handles both single and multiple items - no need for separate single item option -->
            <div class="form-group" id="spike-scope-group" style="display: none;">
                <label for="spike-scope">Apply To</label>
                <select name="spike_scope" id="spike-scope" onchange="handleSpikeScopeChange()" tabindex="7">
                    <option value="multiple" selected>Specific Item(s)</option>
                    <option value="all">All Items</option>
                </select>

                <small class="form-hint">Choose to track specific items or all items at once</small>
            </div>

            <!-- Multi-item selector for spike alerts (shown when "Specific Item(s)" selected) -->
            <!-- What: Allows users to select multiple specific items to monitor for spike threshold -->
            <!-- Why: Users may want to monitor spike on a curated list of items instead of all or just one -->
            <!-- How: Uses box-style input with dropdown arrow - matching spread multi-item selector -->
            <div class="form-group" id="spike-items-group" style="display: none;">
                <div class="label-with-notification">
                    <label for="spike-item-input">Items</label>
                    <!-- =============================================================================
                         ITEM COLLECTION BUTTON - SPIKE ALERTS
                         What: Button to open the Item Collection modal for quick item selection
                         Why: Users can apply saved collections of items instead of selecting one by one
                         How: Opens modal with onclick, passes 'spike' as the alert type parameter
                    ============================================================================= -->
                    <button type="button" class="btn-buy-limit" onclick="ItemCollectionManager.open('spike')" title="Apply a saved item collection">
                        <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                        </svg>
                        Collection
                    </button>
                    <!-- Small notification shown when items are added or not found -->
                    <span id="spike-item-notification" class="item-notification"></span>
                </div>
                <div class="multi-item-selector">
                    <div class="multi-item-selector-box">
                        <!-- Search input for adding new items -->
                        <input type="text" id="spike-item-input" placeholder="Search for item to add..." autocomplete="off" tabindex="8">
                        <!-- Dropdown toggle button with chevron arrow -->
                        <button type="button" class="multi-item-dropdown-toggle" id="spike-multi-item-toggle" title="Show selected items" tabindex="9">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <!-- Hidden input for form submission - stores comma-separated item IDs -->
                        <input type="hidden" name="spike_item_ids" id="spike-item-ids" value="">
                        <!-- Autocomplete suggestions dropdown (shown when typing) -->
                        <div id="spike-item-suggestions" class="multi-item-suggestions-dropdown"></div>
                        <!-- Selected items dropdown (shown when clicking arrow) -->
                        <div id="spike-selected-items-dropdown" class="multi-item-selected-dropdown">
                            <div class="selected-items-list" id="spike-selected-items-list">
                                <!-- Items will be populated here dynamically -->
                            </div>
                            <div class="no-items-message" id="spike-no-items-message">No items selected</div>
                        </div>
                    </div>
                </div>
                <small class="form-hint">Add one or more items to monitor for spike threshold</small>
            </div>

            <!-- Spread-specific fields -->
            <!-- What: Dropdown to choose scope for spread alerts (all items or specific items) -->
            <!-- Why: Users may want to monitor spread on all items or a curated list of specific items -->
            <!-- How: Changes form visibility based on selection; "Specific Item(s)" handles both single and multiple items -->
            <div class="form-group" id="spread-scope-group" style="display: none;">
                <label for="spread-scope">Apply To</label>
                <select name="spread_scope" id="spread-scope" onchange="handleSpreadScopeChange()" tabindex="7">
                    <option value="multiple" selected>Specific Item(s)</option>
                    <option value="all">All Items</option>
                </select>

                <small class="form-hint">Choose to track specific items or all items at once</small>
            </div>

            <!-- Multi-item selector for spread alerts (shown when "Specific Item(s)" selected) -->
            <!-- What: Allows users to select multiple specific items to monitor for spread threshold -->
            <!-- Why: Users may want to monitor spread on a curated list of items instead of all or just one -->
            <!-- How: Uses box-style input with dropdown arrow - matching alert_detail.html styling -->
            <div class="form-group" id="spread-items-group" style="display: none;">
                <div class="label-with-notification">
                    <label for="spread-item-input">Items</label>
                    <!-- =============================================================================
                         ITEM COLLECTION BUTTON - SPREAD ALERTS
                         What: Button to open the Item Collection modal for quick item selection
                         Why: Users can apply saved collections of items instead of selecting one by one
                         How: Opens modal with onclick, passes 'spread' as the alert type parameter
                    ============================================================================= -->
                    <button type="button" class="btn-buy-limit" onclick="ItemCollectionManager.open('spread')" title="Apply a saved item collection">
                        <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                        </svg>
                        Collection
                    </button>
                    <!-- Small notification shown when items are added or not found -->
                    <span id="spread-item-notification" class="item-notification"></span>
                </div>
                <div class="multi-item-selector">
                    <div class="multi-item-selector-box">
                        <!-- Search input for adding new items -->
                        <input type="text" id="spread-item-input" placeholder="Search for item to add..." autocomplete="off" tabindex="8">
                        <!-- Dropdown toggle button with chevron arrow -->
                        <button type="button" class="multi-item-dropdown-toggle" id="spread-multi-item-toggle" title="Show selected items" tabindex="9">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <!-- Hidden input for form submission - stores comma-separated item IDs -->
                        <input type="hidden" name="spread_item_ids" id="spread-item-ids" value="">
                        <!-- Autocomplete suggestions dropdown (shown when typing) -->
                        <div id="spread-item-suggestions" class="multi-item-suggestions-dropdown"></div>
                        <!-- Selected items dropdown (shown when clicking arrow) -->
                        <div id="spread-selected-items-dropdown" class="multi-item-selected-dropdown">
                            <div class="selected-items-list" id="spread-selected-items-list">
                                <!-- Items will be populated here dynamically -->
                            </div>
                            <div class="no-items-message" id="spread-no-items-message">No items selected</div>
                        </div>
                    </div>
                </div>
                <small class="form-hint">Add one or more items to monitor for spread threshold</small>
            </div>

            <!-- Item Name -->
            <!-- What: Input field for selecting a single item to track (used by Above/Below Threshold alerts) -->
            <!-- Why: Some alert types need a specific item rather than multiple items or all items -->
            <!-- How: Uses autocomplete to help users find items by name -->
            <div class="form-group" id="item-name-group">
                <label for="item-name">Item Name</label>
                <input type="text" name="item_name" id="item-name" autocomplete="off" tabindex="8">
                <input type="hidden" name="item_id" id="item-id">
                <input type="hidden" name="is_all_items" id="is-all-items" value="false">
                <div id="item-suggestions" class="suggestions-dropdown"></div>
                <small class="form-hint">Item name you wish to track</small>
            </div>

            <!-- Price Threshold -->
            <!-- What: Input field for target price (used by Above/Below Threshold alerts) -->
            <!-- Why: Users need to specify the price that triggers the alert -->
            <div class="form-group" id="price-group">
                <label for="price">Price Threshold</label>
                <input type="number" name="price" id="price" tabindex="9">
                <small class="form-hint">Target price</small>
            </div>

            <!-- Reference Price -->
            <!-- What: Dropdown to choose which price to use for comparison (high, low, or average) -->
            <!-- Why: Different strategies monitor different price points -->
            <!-- Note: Used by Spike and Sustained alerts - Threshold has its own separate dropdown -->
            <div class="form-group" id="reference-group">
                <label for="reference">Reference Price</label>
                <select name="reference" id="reference" tabindex="16">
                    <option value="high">High (Instant Buy)</option>
                    <option value="low">Low (Instant Sell)</option>
                    <option value="average" selected>Average</option>
                </select>
                <small class="form-hint">Which price to monitor for alert calculations</small>
            </div>

            <!-- Percentage field (shown for spread or spike) -->
            <div class="form-group" id="percentage-group" style="display: none;">
                <label for="percentage">Percentage (%)</label>
                <input type="number" name="percentage" id="percentage" step="0.001" min="0.001" tabindex="11">
                <small class="form-hint">Target percentage your alert must hit</small>
            </div>

            <!-- Time frame field (shown for spike only) -->
            <div class="form-group" id="time-frame-group" style="display: none;">
                <label for="time-frame">Time Frame (minutes)</label>
                <input type="number" name="time_frame" id="time-frame" min="1" step="1" placeholder="e.g. 10" tabindex="17">
                <small class="form-hint">Time frame your alert must trigger within.</small>
            </div>

            <!-- Direction field (shown for spike only) -->
            <div class="form-group" id="direction-group" style="display: none;">
                <label for="direction">Direction</label>
                <select name="direction" id="direction" tabindex="10">
                    <option value="both" selected>Both</option>
                    <option value="up">Up</option>
                    <option value="down">Down</option>
                </select>

                <small class="form-hint">Direction your alert will track</small>
            </div>

            <!-- Sustained Move scope selector -->
            <div class="form-group" id="sustained-scope-group" style="display: none;">
                <label for="sustained-scope">Apply To</label>
                <select name="sustained_scope" id="sustained-scope" onchange="handleSustainedScopeChange()" tabindex="7">
                    <option value="specific" selected>Specific Item(s)</option>
                    <option value="all">All Items</option>
                </select>
                <small class="form-hint">Choose to track a single item or all items</small>
            </div>

            <!-- Multi-item selector for sustained move -->
            <!-- What: Allows users to select multiple specific items to monitor for sustained price moves -->
            <!-- Why: Users may want to monitor sustained moves on a curated list of items -->
            <!-- How: Uses box-style input with dropdown arrow - matching alert_detail.html styling -->
            <div class="form-group" id="sustained-items-group" style="display: none;">
                <div class="label-with-notification">
                    <label for="sustained-item-input">Items</label>
                    <!-- =============================================================================
                         ITEM COLLECTION BUTTON - SUSTAINED ALERTS
                         What: Button to open the Item Collection modal for quick item selection
                         Why: Users can apply saved collections of items instead of selecting one by one
                         How: Opens modal with onclick, passes 'sustained' as the alert type parameter
                    ============================================================================= -->
                    <button type="button" class="btn-buy-limit" onclick="ItemCollectionManager.open('sustained')" title="Apply a saved item collection">
                        <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                        </svg>
                        Collection
                    </button>
                    <!-- Small notification shown when items are added or not found -->
                    <span id="sustained-item-notification" class="item-notification"></span>
                </div>
                <div class="multi-item-selector">
                    <div class="multi-item-selector-box">
                        <!-- Search input for adding new items -->
                        <input type="text" id="sustained-item-input" placeholder="Search for item to add..." autocomplete="off" tabindex="8">
                        <!-- Dropdown toggle button with chevron arrow -->
                        <button type="button" class="multi-item-dropdown-toggle" id="sustained-multi-item-toggle" title="Show selected items" tabindex="9">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <!-- Hidden input for form submission - stores comma-separated item IDs -->
                        <input type="hidden" name="sustained_item_ids" id="sustained-item-ids" value="">
                        <!-- Autocomplete suggestions dropdown (shown when typing) -->
                        <div id="sustained-item-suggestions" class="multi-item-suggestions-dropdown"></div>
                        <!-- Selected items dropdown (shown when clicking arrow) -->
                        <div id="sustained-selected-items-dropdown" class="multi-item-selected-dropdown">
                            <div class="selected-items-list" id="sustained-selected-items-list">
                                <!-- Items will be populated here dynamically -->
                            </div>
                            <div class="no-items-message" id="sustained-no-items-message">No items selected</div>
                        </div>
                    </div>
                </div>
                <small class="form-hint">Add one or more items to monitor</small>
            </div>

            <!-- Min/Max price fields -->
            <!-- What: Input fields for filtering which items to monitor based on their price -->
            <!-- Why: Users may only want to track items within a certain price range (e.g., high-value items only) -->
            <!-- How: These filters apply when "All Items" is selected, narrowing down the monitored items -->
            <!-- Note: Visual order is controlled by CSS flexbox order property in alerts-form.css -->
            <div class="form-group" id="min-price-group" style="display: none;">
                <label for="minimum-price">Minimum Price</label>
                <input type="number" name="minimum_price" id="minimum-price" min="0" tabindex="11">
                <small class="form-hint">The minimum price of an item to track</small>
            </div>
            <div class="form-group" id="max-price-group" style="display: none;">
                <label for="maximum-price">Maximum Price</label>
                <input type="number" name="maximum_price" id="maximum-price" min="0" tabindex="10">
                <small class="form-hint">The maximum price of an item to track</small>
            </div>

            <!-- Sustained Move specific fields -->
            <!-- What: Configuration inputs for Sustained Move alerts -->
            <!-- Why: Users need to define what constitutes a "sustained" price movement -->
            <div class="form-group" id="min-consecutive-moves-group" style="display: none;">
                <label for="min-consecutive-moves">Min Consecutive Moves</label>
                <input type="number" name="min_consecutive_moves" id="min-consecutive-moves" min="2" step="1"
                    placeholder="e.g. 5" tabindex="12">
                <small class="form-hint">Number of price changes in same direction</small>
            </div>
            <div class="form-group" id="min-move-percentage-group" style="display: none;">
                <label for="min-move-percentage">Min Move %</label>
                <input type="number" name="min_move_percentage" id="min-move-percentage" min="0.01" step="0.01"
                    placeholder="e.g. 0.5" tabindex="13">
                <small class="form-hint">Min % change to count as move</small>
            </div>
            <div class="form-group" id="min-volume-group" style="display: none;">
                <label for="min-volume">Min Volume</label>
                <input type="number" name="min_volume" id="min-volume" min="0" step="1" placeholder="e.g. 10000" tabindex="15">
                <small class="form-hint">Min trading volume</small>
            </div>
            <div class="form-group" id="volatility-buffer-group" style="display: none;">
                <label for="volatility-buffer-size">Volatility Buffer (N)</label>
                <input type="number" name="volatility_buffer_size" id="volatility-buffer-size" min="5" step="1"
                    placeholder="e.g. 20" tabindex="18">
                <small class="form-hint">Rolling buffer size for avg volatility</small>
            </div>
            <div class="form-group" id="volatility-multiplier-group" style="display: none;">
                <label for="volatility-multiplier">Volatility Multiplier (K)</label>
                <input type="number" name="volatility_multiplier" id="volatility-multiplier" min="0.1" step="0.1"
                    placeholder="e.g. 1.5" tabindex="19">
                <small class="form-hint">Streak must move â‰¥ K Ã— avg volatility</small>
            </div>

            <!-- Market Pressure Filter (sustained only) -->
            <!-- What: Filters for market pressure conditions on sustained move alerts -->
            <!-- Why: Users may want to only trigger alerts when there's buying/selling pressure -->
            <div class="form-group" id="pressure-strength-group" style="display: none;">
                <label for="min-pressure-strength">Market Pressure</label>
                <select name="min_pressure_strength" id="min-pressure-strength" tabindex="11">
                    <option value="">No Pressure Filter</option>
                    <option value="weak">Weak+ (any time delta)</option>
                    <option value="moderate">Moderate+ (&lt;5min)</option>
                    <option value="strong">Strong (&lt;1min)</option>
                </select>
                <small class="form-hint">BUY=up, SELL=down direction match</small>
            </div>
            <div class="form-group" id="pressure-spread-group" style="display: none;">
                <label for="min-pressure-spread">Min Spread % for Pressure</label>
                <input type="number" name="min_pressure_spread_pct" id="min-pressure-spread" min="0.01" step="0.01"
                    placeholder="e.g. 0.2" tabindex="14">
                <small class="form-hint">Minimum high-low spread % to confirm pressure</small>
            </div>

            <!-- =========================================================================
                 THRESHOLD ALERT SPECIFIC FIELDS
                 What: Form fields for creating Threshold alerts
                 Why: Threshold alerts need unique configuration options (items tracked, threshold type, etc.)
                 How: These fields are shown/hidden via JavaScript when "Threshold" alert type is selected
                 ========================================================================= -->
            
            <!-- Threshold: Items Tracked selector -->
            <!-- What: Dropdown to choose between tracking all items or specific items -->
            <!-- Why: Users may want to monitor threshold on all items or a curated list -->
            <!-- How: Shows/hides the specific items selector based on selection -->
            <!-- Note: "Specific Item(s)" is the default for consistency with other alert types -->
            <div class="form-group" id="threshold-items-tracked-group" style="display: none;">
                <label for="threshold-items-tracked">Apply To</label>
                <select name="threshold_items_tracked" id="threshold-items-tracked" onchange="handleThresholdItemsTrackedChange()" tabindex="7">
                    <option value="specific" selected>Specific Item(s)</option>
                    <option value="all">All Items</option>
                </select>
                <small class="form-hint">Choose to track specific items or all items at once</small>
            </div>

            <!-- Threshold: Multi-item selector (shown when "Specific Item(s)" is selected) -->
            <!-- What: Allows users to select multiple specific items to monitor for threshold -->
            <!-- Why: Users may want to monitor threshold on a curated list of items -->
            <!-- How: Uses box-style input with dropdown arrow - matching spread alert styling -->
            <div class="form-group" id="threshold-items-group" style="display: none;">
                <div class="label-with-notification">
                    <label for="threshold-item-input">Item(s)</label>
                    <!-- =============================================================================
                         ITEM COLLECTION BUTTON - THRESHOLD ALERTS
                         What: Button to open the Item Collection modal for quick item selection
                         Why: Users can apply saved collections of items instead of selecting one by one
                         How: Opens modal with onclick, passes 'threshold' as the alert type parameter
                    ============================================================================= -->
                    <button type="button" class="btn-buy-limit" onclick="ItemCollectionManager.open('threshold')" title="Apply a saved item collection">
                        <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                        </svg>
                        Collection
                    </button>
                    <!-- Small notification shown when items are added or not found -->
                    <span id="threshold-item-notification" class="item-notification"></span>
                </div>
                <div class="multi-item-selector">
                    <div class="multi-item-selector-box">
                        <!-- Search input for adding new items -->
                        <input type="text" id="threshold-item-input" placeholder="Search for item to add..." autocomplete="off" tabindex="8">
                        <!-- Dropdown toggle button with chevron arrow -->
                        <button type="button" class="multi-item-dropdown-toggle" id="threshold-multi-item-toggle" title="Show selected items" tabindex="9">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <!-- Hidden input for form submission - stores comma-separated item IDs -->
                        <input type="hidden" name="threshold_item_ids" id="threshold-item-ids" value="">
                        <!-- Autocomplete suggestions dropdown (shown when typing) -->
                        <div id="threshold-item-suggestions" class="multi-item-suggestions-dropdown"></div>
                        <!-- Selected items dropdown (shown when clicking arrow) -->
                        <div id="threshold-selected-items-dropdown" class="multi-item-selected-dropdown">
                            <div class="selected-items-list" id="threshold-selected-items-list">
                                <!-- Items will be populated here dynamically -->
                            </div>
                            <div class="no-items-message" id="threshold-no-items-message">No items selected</div>
                        </div>
                    </div>
                </div>
                <small class="form-hint">Add one or more items to monitor for threshold</small>
            </div>

            <!-- Threshold: Direction selector -->
            <!-- What: Dropdown to choose whether to alert on price going up or down -->
            <!-- Why: Users may only care about price increases (for selling) or decreases (for buying) -->
            <div class="form-group" id="threshold-direction-group" style="display: none;">
                <label for="threshold-direction">Above or Below</label>
                <select name="threshold_direction" id="threshold-direction" tabindex="10">
                    <option value="up" selected>Above</option>
                    <option value="down">Below</option>
                </select>
                <small class="form-hint">Alert when price hits percentage threshold above or below its current value (or above/below a specified value) </small>
            </div>

            <!-- Threshold: Threshold Type selector -->
            <!-- What: Dropdown to choose between percentage-based or value-based threshold -->
            <!-- Why: Users may want "10% increase" or "1000gp increase" depending on their strategy -->
            <!-- How: Auto-selects percentage when All Items or multiple specific items selected -->
            <div class="form-group" id="threshold-type-group" style="display: none;">
                <label for="threshold-type">
                    Threshold Type
                    <!-- Locked indicator: Shows when threshold type is forced to percentage -->
                    <!-- What: Visual indicator (ðŸš«) that the dropdown is locked -->
                    <!-- Why: Users need to understand why they can't change the threshold type -->
                    <!-- How: Icon appears when dropdown is disabled; clicking shows explanatory tooltip -->
                    <span id="threshold-type-locked-indicator" class="locked-indicator" style="display: none;" title="Click for more info">ðŸš«</span>
                </label>
                <select name="threshold_type" id="threshold-type" tabindex="11">
                    <option value="percentage" selected>Percentage</option>
                    <option value="value">Value (GP)</option>
                </select>
                <!-- Tooltip that appears when user clicks the locked indicator -->
                <!-- What: Explanation popup for why threshold type is locked -->
                <!-- Why: Provides context so users understand the restriction -->
                <!-- How: Shown/hidden via JavaScript when indicator is clicked -->
                <div id="threshold-type-locked-tooltip" class="locked-tooltip" style="display: none;">
                    <span class="locked-tooltip-close">&times;</span>
                    <p>Value-based thresholds can only be used when monitoring a <strong>single item</strong>.</p>
                    <p>When monitoring multiple items or all items, percentage-based thresholds must be used because each item has a different price.</p>
                </div>
                <small class="form-hint">How to measure the threshold (percentage only for multiple items)</small>
            </div>

            <!-- Threshold: Threshold value input -->
            <!-- What: Numeric input for the threshold amount -->
            <!-- Why: Users need to specify how much change should trigger the alert -->
            <!-- How: Value is interpreted as percentage or GP based on threshold_type selection -->
            <div class="form-group" id="threshold-value-group" style="display: none;">
                <label for="threshold-value">Threshold</label>
                <input type="number" name="threshold_value" id="threshold-value" step="0.01" min="0.01" placeholder="e.g. 5" tabindex="13">
                <small class="form-hint" id="threshold-value-hint">The percentage or value change that triggers the alert (use numbers between 0-100)</small>
            </div>

            <!-- Threshold: Reference Price selector -->
            <!-- What: Dropdown to choose which price to monitor (high, low, or average) -->
            <!-- Why: Different strategies use different reference prices -->
            <!-- How: Determines which current price is compared against the threshold -->
            <div class="form-group" id="threshold-reference-group" style="display: none;">
                <label for="threshold-reference">Reference Price</label>
                <select name="threshold_reference" id="threshold-reference" tabindex="12">
                    <option value="high">High (Instant Buy)</option>
                    <option value="low">Low (Instant Sell)</option>
                    <option value="average" selected>Average</option>
                </select>
                <small class="form-hint">Which price to monitor for threshold changes</small>
            </div>

            <!-- =========================================================================
                 COLLECTIVE MOVE ALERT SPECIFIC FIELDS
                 What: Form fields for creating Collective Move alerts
                 Why: Collective Move alerts monitor average percentage change across multiple items
                 How: These fields are shown/hidden via JavaScript when "Collective Move" alert type is selected
                 ========================================================================= -->
            
            <!-- Collective Move: Scope selector -->
            <!-- What: Dropdown to choose between tracking all items or specific items -->
            <!-- Why: Users may want to monitor a curated list or the entire market (filtered by price) -->
            <!-- How: Shows/hides the specific items selector and min/max price based on selection -->
            <div class="form-group" id="collective-scope-group" style="display: none;">
                <label for="collective-scope">Apply To</label>
                <select name="collective_scope" id="collective-scope" onchange="handleCollectiveScopeChange()" tabindex="7">
                    <option value="specific" selected>Specific Item(s)</option>
                    <option value="all">All Items</option>
                </select>
                <small class="form-hint">Choose to track specific items or all items at once</small>
            </div>

            <!-- Collective Move: Multi-item selector (shown when "Specific Item(s)" is selected) -->
            <!-- What: Allows users to select multiple specific items to monitor for collective average -->
            <!-- Why: Users may want to monitor a curated list of items (e.g., all herbs, all ores) -->
            <!-- How: Uses box-style input with dropdown arrow - matching other multi-item selectors -->
            <div class="form-group" id="collective-items-group" style="display: none;">
                <div class="label-with-notification">
                    <label for="collective-item-input">Item(s)</label>
                    <!-- =============================================================================
                         ITEM COLLECTION BUTTON - COLLECTIVE MOVE ALERTS
                         What: Button to open the Item Collection modal for quick item selection
                         Why: Users can apply saved collections of items instead of selecting one by one
                         How: Opens modal with onclick, passes 'collective_move' as the alert type parameter
                    ============================================================================= -->
                    <button type="button" class="btn-buy-limit" onclick="ItemCollectionManager.open('collective_move')" title="Apply a saved item collection">
                        <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                        </svg>
                        Collection
                    </button>
                    <!-- Small notification shown when items are added or not found -->
                    <span id="collective-item-notification" class="item-notification"></span>
                </div>
                <div class="multi-item-selector">
                    <div class="multi-item-selector-box">
                        <!-- Search input for adding new items -->
                        <input type="text" id="collective-item-input" placeholder="Search for item to add..." autocomplete="off" tabindex="8">
                        <!-- Dropdown toggle button with chevron arrow -->
                        <button type="button" class="multi-item-dropdown-toggle" id="collective-multi-item-toggle" title="Show selected items" tabindex="9">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <!-- Hidden input for form submission - stores comma-separated item IDs -->
                        <input type="hidden" name="collective_item_ids" id="collective-item-ids" value="">
                        <!-- Autocomplete suggestions dropdown (shown when typing) -->
                        <div id="collective-item-suggestions" class="multi-item-suggestions-dropdown"></div>
                        <!-- Selected items dropdown (shown when clicking arrow) -->
                        <div id="collective-selected-items-dropdown" class="multi-item-selected-dropdown">
                            <div class="selected-items-list" id="collective-selected-items-list">
                                <!-- Items will be populated here dynamically -->
                            </div>
                            <div class="no-items-message" id="collective-no-items-message">No items selected</div>
                        </div>
                    </div>
                </div>
                <small class="form-hint">Add items to monitor for collective average movement</small>
            </div>

            <!-- Collective Move: Reference Price selector -->
            <!-- What: Dropdown to choose which price to use for baseline and comparison (high, low, or average) -->
            <!-- Why: Different strategies use different price points -->
            <!-- How: Determines which price type is used for storing baselines and calculating % change -->
            <div class="form-group" id="collective-reference-group" style="display: none;">
                <label for="collective-reference">Reference Price</label>
                <select name="collective_reference" id="collective-reference" tabindex="10">
                    <option value="high">High (Instant Buy)</option>
                    <option value="low">Low (Instant Sell)</option>
                    <option value="average" selected>Average</option>
                </select>
                <small class="form-hint">Which price to use for calculating percentage change</small>
            </div>

            <!-- Collective Move: Calculation Method selector -->
            <!-- What: Dropdown to choose between simple (arithmetic mean) or weighted (by value) average -->
            <!-- Why: Simple mean treats all items equally; weighted gives more influence to expensive items -->
            <!-- How: 'simple' = sum(changes)/count, 'weighted' = sum(change*value)/sum(values) -->
            <div class="form-group" id="collective-calculation-method-group" style="display: none;">
                <label for="collective-calculation-method">Calculation Method</label>
                <select name="collective_calculation_method" id="collective-calculation-method" tabindex="11">
                    <option value="simple" selected>Non Weighted (Equal Items)</option>
                    <option value="weighted">Weighted by Value</option>
                </select>
                <small class="form-hint">How to calculate the average: simple treats all items equally, weighted gives more influence to expensive items</small>
            </div>

            <!-- Collective Move: Direction selector -->
            <!-- What: Dropdown to choose whether to alert on average going up, down, or both -->
            <!-- Why: Users may only care about collective increases or decreases depending on strategy -->
            <!-- How: 'up' alerts when average >= threshold, 'down' when average <= -threshold, 'both' when |average| >= threshold -->
            <div class="form-group" id="collective-direction-group" style="display: none;">
                <label for="collective-direction">Direction</label>
                <select name="collective_direction" id="collective-direction" tabindex="12">
                    <option value="up">Up (Collective Increase)</option>
                    <option value="down">Down (Collective Decrease)</option>
                    <option value="both" selected>Both (Any Direction)</option>
                </select>
                <small class="form-hint">Alert when the average moves up, down, or either direction</small>
            </div>

            <!-- Collective Move: Threshold input -->
            <!-- What: Numeric input for the percentage threshold -->
            <!-- Why: Users need to specify what average percentage change should trigger the alert -->
            <!-- How: Alert triggers when average change crosses this threshold in the specified direction -->
            <div class="form-group" id="collective-threshold-group" style="display: none;">
                <label for="collective-threshold">Threshold (%)</label>
                <input type="number" name="collective_threshold" id="collective-threshold" step="0.01" min="0.01" placeholder="e.g. 5" tabindex="13">
                <small class="form-hint">The average percentage change that triggers the alert (e.g., 5 for 5%)</small>
            </div>

            <!-- =====================================================================================
                 NOTIFICATION OPTIONS (ALWAYS LAST)

                 What: These are the two â€œdelivery channelâ€ toggles for an alert.
                 Why: You requested these appear LAST for Threshold/Sustained/Spike/Spread (and visually this
                      is also the most natural place for them for other alert types).
                 How: We give the container divs stable IDs so CSS can:
                      1) force them to the end of the form (via flexbox order)
                      2) render them on ONE LINE (by removing the old 100%-width rule)
                 ===================================================================================== -->
            <div class="form-check d-flex align-items-center" style="padding-right: 4em; margin-top:35px !important" id="show-notification-group">
                    <input style = "transform: scale(1.35); margin-top: 0;" type="checkbox" class="form-check-input me-2" name="show_notification" id="show-notification" checked tabindex="90">
                <label class="form-check-label">
                    <span>Show Alert Notification?</span>
                </label>
            </div>

            <div class="form-check d-flex align-items-center" style="padding-right: 4em; margin-top:35px !important" id="sms-notification-group">
                <input style = "transform: scale(1.35); margin-top: 0;" type="checkbox" class="form-check-input me-2" name="email_notification" id="email-notification" tabindex="91">
                <label class="form-check-label">
                  
                    <span>Receive SMS Notification?</span>
                </label>
            </div>

            <button type="submit" class="btn-create-alert" tabindex="100">Create Alert</button>
        </form>
    </div>
</div>

<!-- Spread Details Modal -->
<div id="spread-modal" class="modal" style="display: none;">
    <div class="modal-content modal-content-large">
        <div class="modal-header">
            <h2>Spread Alert Details</h2>
            <button class="modal-close" onclick="closeSpreadModal()">&times;</button>
        </div>
        <div id="spread-modal-body">
            <ul id="spread-items-list"></ul>
        </div>
        <div class="modal-buttons">
            <button type="button" class="btn-cancel" onclick="closeSpreadModal()">Close</button>
        </div>
    </div>
</div>

<!-- Spike Details Modal -->
<div id="spike-modal" class="modal" style="display: none;">
    <div class="modal-content modal-content-large">
        <div class="modal-header">
            <h2>Spike Alert Details</h2>
            <button class="modal-close" onclick="closeSpikeModal()">&times;</button>
        </div>
        <div id="spike-modal-body">
            <ul id="spike-items-list"></ul>
        </div>
        <div class="modal-buttons">
            <button type="button" class="btn-cancel" onclick="closeSpikeModal()">Close</button>
        </div>
    </div>
</div>

<!-- Group Alerts Modal -->
<div id="group-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Organize Alerts</h2>
            <button class="modal-close" onclick="GroupManager.close()">&times;</button>
        </div>
        <div class="form-group">
            <label>Existing Groups</label>
            <div id="group-list" class="group-list"></div>
        </div>
        <div class="form-group">
            <label for="new-group-input">Add New Groups</label>
            <input type="text" id="new-group-input" placeholder="Comma-separated, e.g. Bossing, Supplies">
        </div>
        <div class="modal-buttons">
            <button type="button" class="btn-save" onclick="GroupManager.save()">Save</button>
            <button type="button" class="btn-delete-group" onclick="GroupManager.deleteSelectedGroups()">Delete
                Group(s)</button>
            <button type="button" class="btn-cancel" onclick="GroupManager.close()">Cancel</button>
        </div>
    </div>
</div>

<!-- Groups Filter Modal -->
<div id="groups-filter-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Filter by Groups</h2>
            <button class="modal-close" onclick="closeGroupsFilterModal()">&times;</button>
        </div>
        <div class="form-group">
            <label>Select Groups to Display</label>
            <div id="groups-filter-list" class="group-list pill-padding"></div>
            <p id="no-groups-message" class="no-alerts" style="display: none;">No groups available. Create groups by
                organizing your alerts first.</p>
        </div>
        <div class="modal-buttons">
            <button type="button" class="btn-save" onclick="applyGroupsFilter()">Apply Filter</button>
            <button type="button" class="btn-cancel" onclick="closeGroupsFilterModal()">Cancel</button>
        </div>
    </div>
</div>

<!-- Price Filter Modal -->
<div id="price-filter-modal" class="modal filter-modal-styled" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Filter by Price</h2>
            <button class="modal-close" onclick="closePriceFilterModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="filter-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <p class="filter-description">Show alerts with current price in a specific range.</p>
            <div class="form-group">
                <label for="price-filter-min">Minimum Price</label>
                <input type="number" id="price-filter-min" placeholder="No minimum">
            </div>
            <div class="form-group">
                <label for="price-filter-max">Maximum Price</label>
                <input type="number" id="price-filter-max" placeholder="No maximum">
            </div>
        </div>
        <div class="modal-buttons">
            <button type="button" class="btn-clear" onclick="clearPriceFilter()">Clear</button>
            <button type="button" class="btn-save" onclick="applyPriceFilter()">Apply Filter</button>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-confirm-modal" class="modal delete-confirm-modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Confirm Delete</h2>
            <button class="modal-close" onclick="closeDeleteConfirmModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="delete-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
            </div>
            <p id="delete-confirm-message">Are you sure you want to delete the selected alerts?</p>
            <p class="delete-warning">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn-cancel" onclick="closeDeleteConfirmModal()">Cancel</button>
            <button type="button" class="btn-confirm-delete" onclick="executeDelete()">Delete</button>
        </div>
    </div>
</div>

<!-- =============================================================================
     NEW GROUP MODAL
     What: Modal dialog for creating a new alert group while creating an alert
     Why: Users need a way to create groups inline without leaving the page
     How: Overlay with input field, Create/Cancel buttons, adds to AlertsState.alertGroups
============================================================================= -->
<div id="new-group-modal" class="new-group-modal-overlay">
    <div class="new-group-modal-content">
        <div class="new-group-modal-header">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
            </svg>
            <h3>Create New Group</h3>
        </div>
        <div class="new-group-modal-body">
            <label for="new-group-name-input">Group Name</label>
            <input type="text" id="new-group-name-input" placeholder="Enter group name..." maxlength="100" autocomplete="off">
            <p class="form-hint">Choose a descriptive name for your alert group</p>
        </div>
        <div class="new-group-modal-footer">
            <button type="button" class="new-group-modal-btn cancel" onclick="closeNewGroupModal()">Cancel</button>
            <button type="button" class="new-group-modal-btn create" id="create-group-btn" onclick="createNewGroup()">Create Group</button>
        </div>
    </div>
</div>


<!-- =============================================================================
     ITEM COLLECTION MODAL
     What: Modal dialog for managing and applying item collections to alerts
     Why: Users can save groups of items they commonly use together and quickly
          apply them to new alerts, reducing repetitive item selection
     How: Modal has two views: 
          1) Select View - Browse/apply/delete existing collections
          2) Create View - Create new collections with name and items
          User can switch between views using navigation buttons
     Variables:
       - item-collection-modal: Main modal container overlay element
       - item-collection-modal-content: Inner content container for the modal
       - item-collection-select-view: The view for browsing existing collections
       - item-collection-create-view: The view for creating new collections
============================================================================= -->
<div class="item-collection-modal-overlay" id="item-collection-modal">
    <div class="item-collection-modal-content">
        <!-- =============================================================================
             MODAL HEADER
             What: Header section with title and close button
             Why: Provides clear context and easy way to dismiss modal
             How: Uses flex layout with title left, close button right
        ============================================================================= -->
        <div class="item-collection-modal-header">
            <h3>
                <svg viewBox="0 0 20 20" fill="currentColor" width="20" height="20">
                    <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                </svg>
                Item Collections
            </h3>
            <button class="item-collection-close-btn" onclick="ItemCollectionManager.close()" title="Close">
                &times;
            </button>
        </div>

        <!-- =============================================================================
             SELECT VIEW - Browse and apply existing collections
             What: View that displays all saved collections for selection/deletion
             Why: Users need to see their collections and apply or manage them
             How: Shows list of collections, each with apply and delete buttons
                  If no collections exist, shows create prompt instead
        ============================================================================= -->
        <div class="item-collection-view" id="item-collection-select-view">
            <!-- =============================================================================
                 COLLECTIONS LIST CONTAINER
                 What: Scrollable container showing all user's saved collections
                 Why: Users may have many collections, needs to be scrollable
                 How: Shows each collection as a card with name, item count, and actions
            ============================================================================= -->
            <div class="item-collection-list-container">
                <div class="item-collection-list" id="item-collection-list">
                    <!-- Collections will be populated dynamically by JavaScript -->
                </div>
                <!-- =============================================================================
                     EMPTY STATE MESSAGE
                     What: Shown when user has no saved collections
                     Why: Guide user to create their first collection
                     How: Hidden by default, shown via JS when collections array is empty
                ============================================================================= -->
                <div class="item-collection-empty" id="item-collection-empty">
                    <svg viewBox="0 0 20 20" fill="currentColor" width="48" height="48">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                    </svg>
                    <p>No collections yet</p>
                    <span>Create your first item collection to get started</span>
                </div>
            </div>

            <!-- =============================================================================
                 APPLICATION MODE SELECTOR
                 What: Radio buttons to choose merge vs replace when applying collection
                 Why: User may want to add to existing items OR replace them entirely
                 How: Two radio buttons, selection stored and used when Apply is clicked
            ============================================================================= -->
            <div class="item-collection-apply-mode" id="item-collection-apply-mode">
                <label class="apply-mode-label">When applying:</label>
                <div class="apply-mode-options">
                    <label class="apply-mode-option">
                        <input type="radio" name="apply-mode" value="merge" checked>
                        <span class="apply-mode-text">
                            <strong>Merge</strong>
                            <small>Add to existing items</small>
                        </span>
                    </label>
                    <label class="apply-mode-option">
                        <input type="radio" name="apply-mode" value="replace">
                        <span class="apply-mode-text">
                            <strong>Replace</strong>
                            <small>Clear existing items first</small>
                        </span>
                    </label>
                </div>
            </div>

            <!-- =============================================================================
                 SELECT VIEW FOOTER BUTTONS
                 What: Navigation and action buttons for the select view
                 Why: User needs to switch to create view or close modal
                 How: "Create New" switches to create view, "Close" dismisses modal
            ============================================================================= -->
            <div class="item-collection-modal-buttons">
                <button type="button" class="item-collection-btn secondary" onclick="ItemCollectionManager.close()">
                    Close
                </button>
                <button type="button" class="item-collection-btn primary" onclick="ItemCollectionManager.showCreateView()">
                    <svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16">
                        <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"/>
                    </svg>
                    Create New Collection
                </button>
            </div>
        </div>

        <!-- =============================================================================
             CREATE VIEW - Create new item collections (also used for editing)
             What: View for creating a new collection or editing an existing one
             Why: Users need a way to define new collections and modify existing ones
             How: Form with name input, multi-item selector, preview card, and save button
                  Header text changes dynamically based on create vs edit mode
        ============================================================================= -->
        <div class="item-collection-view hidden" id="item-collection-create-view">
            <!-- =============================================================================
                 CREATE/EDIT VIEW HEADER
                 What: Dynamic header that shows "Create New Collection" or "Edit Collection"
                 Why: Same view is used for both operations, header indicates current mode
                 How: Text content is updated by JavaScript based on editingCollectionId
            ============================================================================= -->
            <h4 class="item-collection-view-header" id="create-view-header">Create New Collection</h4>
            
            <!-- =============================================================================
                 COLLECTION NAME INPUT
                 What: Text input for naming the collection
                 Why: Collections need unique, descriptive names for easy identification
                 How: Standard text input with placeholder and validation
            ============================================================================= -->
            <div class="item-collection-form-group">
                <label for="collection-name-input">Collection Name</label>
                <input type="text" id="collection-name-input" placeholder="e.g., High-Value Flips, Daily Watchlist..." maxlength="100" autocomplete="off">
                <small class="form-hint">Give your collection a memorable name</small>
            </div>

            <!-- =============================================================================
                 MULTI-ITEM SELECTOR FOR COLLECTION
                 What: Item selector matching the existing multi-item UI pattern
                 Why: Must function exactly like other item selectors for consistency
                 How: Uses same structure as spike/spread/sustained/threshold selectors:
                      - Text input with autocomplete suggestions
                      - Dropdown toggle button with chevron
                      - Suggestions dropdown (appears when typing)
                      - Selected items dropdown (appears when clicking chevron)
            ============================================================================= -->
            <div class="item-collection-form-group">
                <div class="label-with-notification">
                    <label for="collection-item-input">Items</label>
                    <span id="collection-item-notification" class="item-notification"></span>
                </div>
                <div class="multi-item-selector">
                    <div class="multi-item-selector-box">
                        <!-- Search input for adding items to collection -->
                        <input type="text" id="collection-item-input" placeholder="Search for item to add..." autocomplete="off">
                        <!-- Dropdown toggle button with chevron arrow -->
                        <button type="button" class="multi-item-dropdown-toggle" id="collection-multi-item-toggle" title="Show selected items">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <!-- Autocomplete suggestions dropdown (shown when typing) -->
                        <div id="collection-item-suggestions" class="multi-item-suggestions-dropdown"></div>
                        <!-- Selected items dropdown (shown when clicking arrow) -->
                        <div id="collection-selected-items-dropdown" class="multi-item-selected-dropdown">
                            <div class="selected-items-list" id="collection-selected-items-list">
                                <!-- Items will be populated dynamically -->
                            </div>
                            <div class="no-items-message" id="collection-no-items-message">No items selected</div>
                        </div>
                    </div>
                </div>
                <small class="form-hint">Add items to include in this collection</small>
            </div>

            <!-- =============================================================================
                 ITEMS PREVIEW CARD
                 What: Scrollable card showing all items that will be in the collection
                 Why: User requested preview of items before saving
                 How: Shows list of item names, updates dynamically as items are added/removed
            ============================================================================= -->
            <div class="item-collection-preview" id="collection-items-preview">
                <div class="preview-header">
                    <span class="preview-title">Items in Collection</span>
                    <span class="preview-count" id="collection-preview-count">0 items</span>
                </div>
                <div class="preview-items-list" id="collection-preview-list">
                    <div class="preview-empty">No items added yet</div>
                </div>
            </div>

            <!-- =============================================================================
                 CREATE/EDIT VIEW FOOTER BUTTONS
                 What: Action buttons for saving or canceling collection creation/editing
                 Why: User needs to save changes or go back
                 How: Two buttons - Back (return to select view) and Save
            ============================================================================= -->
            <div class="item-collection-modal-buttons">
                <button type="button" class="item-collection-btn secondary" onclick="ItemCollectionManager.showSelectView()">
                    <svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16">
                        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/>
                    </svg>
                    Back
                </button>
                <button type="button" class="item-collection-btn primary" onclick="ItemCollectionManager.saveCollection(false)" id="save-collection-btn">
                    Save
                </button>
            </div>
        </div>

        <!-- =============================================================================
             DELETE CONFIRMATION VIEW
             What: Confirmation dialog before deleting a collection
             Why: Prevent accidental deletion of collections
             How: Shows collection name and confirm/cancel buttons
        ============================================================================= -->
        <div class="item-collection-view hidden" id="item-collection-delete-view">
            <div class="delete-confirmation">
                <svg viewBox="0 0 20 20" fill="currentColor" width="48" height="48" class="delete-icon">
                    <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                </svg>
                <h4>Delete Collection?</h4>
                <p>Are you sure you want to delete "<span id="delete-collection-name"></span>"?</p>
                <p class="delete-warning">This action cannot be undone.</p>
            </div>
            <div class="item-collection-modal-buttons">
                <button type="button" class="item-collection-btn secondary" onclick="ItemCollectionManager.showSelectView()">
                    Cancel
                </button>
                <button type="button" class="item-collection-btn danger" onclick="ItemCollectionManager.confirmDelete()" id="confirm-delete-btn">
                    Delete Collection
                </button>
            </div>
        </div>
    </div>
</div>


<script>
    // Set CSRF token for use in external JavaScript files
    window.CSRF_TOKEN = '{{ csrf_token }}';
</script>


<!-- Alert Help Modal -->
<div class="alert-help-modal-overlay" id="alertHelpModal">
    <div class="alert-help-modal">
        <div class="alert-help-modal-header">
            <h2>
                <svg viewBox="0 0 20 20" fill="currentColor" width="24" height="24">
                    <path fill-rule="evenodd"
                        d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                        clip-rule="evenodd" />
                </svg>
                Understanding Alert Types
            </h2>
            <button class="alert-help-modal-close" onclick="closeAlertHelpModal()">&times;</button>
        </div>
        <div class="alert-help-modal-body">
            <div class="alert-help-tabs">
                <button class="alert-help-tab" data-help-tab="spread">Spread</button>
                <button class="alert-help-tab" data-help-tab="spike">Spike</button>
                <button class="alert-help-tab" data-help-tab="sustained">Sustained</button>
                <button class="alert-help-tab" data-help-tab="threshold">Threshold</button>
            </div>
            <div class="alert-help-content">
                <!-- Spread Alert -->
                <div class="alert-help-section" data-help-section="spread">
                    <h3>
                        Spread Alert
                        <span class="alert-type-badge spread">Flip Margin</span>
                    </h3>
                    <p class="subtitle">Get notified when the buy/sell margin (spread) exceeds a percentage. Essential
                        for finding profitable flipping opportunities.</p>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                    clip-rule="evenodd" />
                            </svg>
                            How It Works
                        </h4>
                        <p>The <strong>spread</strong> is the percentage difference between the high price (what buyers
                            pay) and the low price (what sellers receive). A higher spread means more potential profit
                            per flip.</p>
                        <p style="margin-top: 12px;"><strong>Formula:</strong> Spread % = ((High Price - Low Price) /
                            Low Price) Ã— 100</p>
                        
                        <div class="input-fields-guide" style="margin-top: 16px;">
                            <h5 style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--text);">ðŸ“ Input Fields Explained:</h5>
                            <ul>
                                <li><strong>Apply To:</strong> Choose what items to monitor:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Specific Item(s)</em> - Select one or more specific items you want to track. Great for monitoring your favorite flip items.</li>
                                        <li><em>All Items</em> - Scan the entire Grand Exchange for any item meeting your spread criteria. Requires price filters to avoid noise.</li>
                                    </ul>
                                </li>
                                <li><strong>Items</strong> (when Specific Item(s) selected): Type to search for items. Click an item to add it to your list. Click the dropdown arrow to see/remove selected items. You can add multiple items to monitor simultaneously.</li>
                                <li><strong>Percentage (%):</strong> The minimum spread percentage that will trigger the alert. For example, entering "5" means you'll be notified when an item has a 5%+ margin between buy and sell prices.</li>
                                <li><strong>Minimum Price</strong> (when All Items selected): Only monitor items worth at least this much GP. Filters out low-value junk items. Enter raw number (e.g., 1000000 for 1M).</li>
                                <li><strong>Maximum Price</strong> (when All Items selected): Only monitor items worth at most this much GP. Useful for staying within your cash stack limits.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                                <path fill-rule="evenodd"
                                    d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z"
                                    clip-rule="evenodd" />
                            </svg>
                            When To Use
                        </h4>
                        <ul>
                            <li>Finding items worth flipping across the entire GE</li>
                            <li>Monitoring your favorite flip items for optimal margins</li>
                            <li>Setting up "All Items" alerts to discover new opportunities</li>
                        </ul>
                    </div>

                    <div class="example-scenario">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path
                                    d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z" />
                            </svg>
                            Example Scenario
                        </h4>
                        <p>Set an "All Items" spread alert for 5% with a minimum price of 1,000,000 gp. You'll be
                            notified whenever any item worth 1M+ has a 5%+ margin - perfect for finding high-value
                            flips!</p>
                    </div>

                    <div class="recommended-values">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd" />
                            </svg>
                            Recommended Starting Values
                        </h4>
                        <div class="value-grid">
                            <div class="recommended-value">
                                <div class="label">Spread Percentage</div>
                                <div class="value">3-5% for high-value items</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Minimum Price</div>
                                <div class="value">500,000 - 1,000,000 gp</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Maximum Price</div>
                                <div class="value">Based on your cash stack</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Spike Alert -->
                <div class="alert-help-section" data-help-section="spike">
                    <h3>
                        Spike Alert
                        <span class="alert-type-badge spike">Rapid Change</span>
                    </h3>
                    <p class="subtitle">Get notified when an item's price changes rapidly within a time window. Catch
                        sudden market movements as they happen.</p>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                    clip-rule="evenodd" />
                            </svg>
                            How It Works
                        </h4>
                        <p>Spike alerts use a <strong>rolling time window</strong> to compare the current price against
                            the price from exactly <em>[time frame]</em> ago. If the price change exceeds your threshold,
                            you'll be notified.</p>
                        
                        <div class="input-fields-guide" style="margin-top: 16px;">
                            <h5 style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--text);">ðŸ“ Input Fields Explained:</h5>
                            <ul>
                                <li><strong>Apply To:</strong> Choose what items to monitor:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Specific Item(s)</em> - Select one or more specific items to track for price spikes. The multi-item selector handles both single and multiple items.</li>
                                        <li><em>All Items</em> - Scan the entire Grand Exchange for any item spiking. Requires price filters to avoid noise from low-value items.</li>
                                    </ul>
                                </li>
                                <li><strong>Items</strong> (when Specific Item(s) selected): Type to search for items. Click an item to add it. Click the dropdown arrow to see/remove selected items. Monitor multiple items simultaneously.</li>
                                <li><strong>Percentage (%):</strong> The minimum price change percentage that triggers the alert. For example, "10" means a 10% price change within your time frame will trigger. Enter values between 0.001 and 100.</li>
                                <li><strong>Time Frame (minutes):</strong> The rolling window for comparison. The alert compares the current price to the price from exactly this many minutes ago. For example, "60" compares current price to the price 1 hour ago.</li>
                                <li><strong>Direction:</strong> Which price movements to track:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Both</em> - Alert on both price increases AND decreases. Best for catching all market movements.</li>
                                        <li><em>Up</em> - Only alert when price increases by the percentage. Good for catching pumps.</li>
                                        <li><em>Down</em> - Only alert when price decreases by the percentage. Good for catching crashes/buying opportunities.</li>
                                    </ul>
                                </li>
                                <li><strong>Minimum Price</strong> (when All Items selected): Only monitor items worth at least this much GP. Filters out cheap items that spike frequently due to low volume.</li>
                                <li><strong>Maximum Price</strong> (when All Items selected): Only monitor items worth at most this much GP. Useful for filtering to your budget range.</li>
                            </ul>
                        </div>
                        
                        <div class="alert-help-note" style="margin-top: 12px; padding: 10px; background: rgba(255, 193, 7, 0.1); border-radius: 6px; border-left: 3px solid #ffc107;">
                            <strong>â³ Warmup Period:</strong> The alert won't trigger until enough time has passed to establish a baseline.
                            For example, a 10-minute spike alert needs 10 minutes of price data before it can make valid comparisons.
                        </div>
                    </div>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                                <path fill-rule="evenodd"
                                    d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z"
                                    clip-rule="evenodd" />
                            </svg>
                            When To Use
                        </h4>
                        <ul>
                            <li>Catching items that spike after game updates or news</li>
                            <li>Detecting crash opportunities to buy low</li>
                            <li>Monitoring volatile items for trading opportunities</li>
                            <li>Setting "All Items" to find any item spiking in the market</li>
                            <li>Watching a curated list of items with "Specific Item(s)" mode</li>
                        </ul>
                    </div>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                    clip-rule="evenodd" />
                            </svg>
                            Multi-Item Behavior
                        </h4>
                        <p>When monitoring <strong>multiple specific items</strong>:</p>
                        <ul>
                            <li><strong>Triggers:</strong> When <em>any</em> item exceeds the threshold</li>
                            <li><strong>Re-triggers:</strong> When the triggered items or their percentages change</li>
                            <li><strong>No spam:</strong> Won't re-notify if the same items have the same values</li>
                            <li><strong>Deactivates:</strong> Only when <em>all</em> items are simultaneously within the threshold</li>
                        </ul>
                    </div>

                    <div class="example-scenario">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path
                                    d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z" />
                            </svg>
                            Example Scenario
                        </h4>
                        <p>Set an "All Items" spike alert for 10% within 60 minutes, direction "Up", with minimum price
                            100,000 gp. When any item worth 100k+ jumps 10% in an hour, you'll be the first to know!</p>
                    </div>

                    <div class="recommended-values">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd" />
                            </svg>
                            Recommended Starting Values
                        </h4>
                        <div class="value-grid">
                            <div class="recommended-value">
                                <div class="label">Percentage Change</div>
                                <div class="value">5-10%</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Time Frame</div>
                                <div class="value">30-60 minutes</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Direction</div>
                                <div class="value">Both (to catch all movements)</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Minimum Price</div>
                                <div class="value">100,000+ gp</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sustained Move Alert -->
                <div class="alert-help-section" data-help-section="sustained">
                    <h3>
                        Sustained Move Alert
                        <span class="alert-type-badge sustained">Trend Detection</span>
                    </h3>
                    <p class="subtitle">Get notified when an item shows consistent price movement in one direction.
                        Detect emerging trends before they become obvious.</p>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                    clip-rule="evenodd" />
                            </svg>
                            How It Works
                        </h4>
                        <p>Unlike spike alerts that catch sudden moves, sustained move alerts detect <strong>consistent
                                trends</strong>. They look for multiple consecutive price movements in the same
                            direction, filtering out noise to find real trends.</p>
                        
                        <div class="input-fields-guide" style="margin-top: 16px;">
                            <h5 style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--text);">ðŸ“ Input Fields Explained:</h5>
                            <ul>
                                <li><strong>Apply To:</strong> Choose what items to monitor:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Specific Item(s)</em> - Select one or more specific items to track for sustained price trends.</li>
                                        <li><em>All Items</em> - Scan the entire Grand Exchange for any item showing sustained movement. Use with price filters.</li>
                                    </ul>
                                </li>
                                <li><strong>Items</strong> (when Specific Item(s) selected): Type to search for items. Click to add to your watchlist. Click the dropdown arrow to see/remove selected items.</li>
                                <li><strong>Min Consecutive Moves:</strong> How many consecutive price updates must move in the same direction to trigger. For example, "5" means 5 data points in a row must all be going up (or all going down). Minimum value is 2.</li>
                                <li><strong>Min Move %:</strong> The minimum percentage change for each individual price movement to count. For example, "0.5" means each move must be at least 0.5% - smaller changes are ignored as noise. Helps filter out tiny fluctuations.</li>
                                <li><strong>Direction:</strong> Which trends to track:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Both</em> - Alert on both upward AND downward trends.</li>
                                        <li><em>Up</em> - Only alert when price is trending upward consistently.</li>
                                        <li><em>Down</em> - Only alert when price is trending downward consistently.</li>
                                    </ul>
                                </li>
                                <li><strong>Min Volume:</strong> Only consider items with at least this many trades. Filters out low-activity items where price movements may be unreliable.</li>
                                <li><strong>Volatility Buffer (N):</strong> The rolling buffer size used to calculate average volatility. A larger buffer (e.g., 20) means smoother volatility estimates over more data points.</li>
                                <li><strong>Volatility Multiplier (K):</strong> The total sustained move must exceed K Ã— average volatility to trigger. Higher values (e.g., 1.5-2.0) filter out normal market noise by requiring the trend to be significantly larger than typical price swings.</li>
                                <li><strong>Market Pressure:</strong> Optional filter based on buy/sell pressure:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>No Pressure Filter</em> - Don't filter by market pressure.</li>
                                        <li><em>Weak+</em> - Requires any detected buying/selling pressure.</li>
                                        <li><em>Moderate+</em> - Requires pressure detected within 5 minutes.</li>
                                        <li><em>Strong</em> - Requires pressure detected within 1 minute.</li>
                                    </ul>
                                </li>
                                <li><strong>Min Spread % for Pressure:</strong> Minimum high-low spread percentage required to confirm market pressure. Higher values ensure the spread is meaningful.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                                <path fill-rule="evenodd"
                                    d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z"
                                    clip-rule="evenodd" />
                            </svg>
                            When To Use
                        </h4>
                        <ul>
                            <li>Detecting items being manipulated or merched</li>
                            <li>Finding items trending up before a big spike</li>
                            <li>Catching items in decline before they crash further</li>
                            <li>Identifying genuine market trends vs random noise</li>
                        </ul>
                    </div>

                    <div class="example-scenario">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path
                                    d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z" />
                            </svg>
                            Example Scenario
                        </h4>
                        <p>Set a sustained move alert for "All Items" with 5 consecutive moves, 0.5% minimum move,
                            direction "Up". When any item moves up 5 times in a row, each by at least 0.5%, you'll catch
                            the trend early!</p>
                    </div>

                    <div class="recommended-values">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd" />
                            </svg>
                            Recommended Starting Values
                        </h4>
                        <div class="value-grid">
                            <div class="recommended-value">
                                <div class="label">Consecutive Moves</div>
                                <div class="value">4-6 moves</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Min Move %</div>
                                <div class="value">0.3-0.5%</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Direction</div>
                                <div class="value">Both (catch all trends)</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Min Volume</div>
                                <div class="value">100+ (filters low-trade items)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Threshold Alert -->
                <div class="alert-help-section" data-help-section="threshold">
                    <h3>
                        Threshold Alert
                        <span class="alert-type-badge threshold">Price Change</span>
                    </h3>
                    <p class="subtitle">Get notified when an item's price changes by a specific percentage or GP value from its baseline.
                        Flexible monitoring for price movements in either direction.</p>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                    clip-rule="evenodd" />
                            </svg>
                            How It Works
                        </h4>
                        <p>Threshold alerts compare the current price against a <strong>baseline price</strong> (captured when the alert is created), or when price crosses over a specific value you specify. When tracking more than one item, only percentage thresholds are available.
                            When the price changes by your specified percentage or GP amount, you'll be notified. Unlike spike alerts that use
                            rolling time windows, threshold alerts use a fixed reference point.</p>
                        
                        <div class="input-fields-guide" style="margin-top: 16px;">
                            <h5 style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--text);">ðŸ“ Input Fields Explained:</h5>
                            <ul>
                                <li><strong>Apply To:</strong> Choose what items to monitor:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Specific Item(s)</em> - Select one or more specific items. Best for tracking items you own or want to buy.</li>
                                        <li><em>All Items</em> - Scan the entire Grand Exchange. The threshold type is automatically locked to "Percentage" for this mode. Use with price filters.</li>
                                    </ul>
                                </li>
                                <li><strong>Items</strong> (when Specific Item(s) selected): Type to search for items. Click to add. Click the dropdown arrow to see/remove selected items. Each item gets its own baseline price when the alert is created.</li>
                                <li><strong>Direction:</strong> Which price movements to track:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Up</em> - Only alert when price increases above baseline by the threshold amount.</li>
                                        <li><em>Down</em> - Only alert when price decreases below baseline by the threshold amount.</li>
                                    </ul>
                                </li>
                                <li><strong>Threshold Type:</strong> How to measure the price change:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>Percentage</em> - Alert triggers when price changes by X% with respect to its value at alert creation time. For example, "10" means a 10% change from baseline. Best for comparing items of different values.</li>
                                        <li><em>Value (GP)</em> - Alert triggers when price crosses above or below a specified value.</li>
                                    </ul>
                                </li>
                                <li><strong>Threshold:</strong> The amount of change required to trigger the alert. Enter a number between 0.01 and 100 for percentages, or any GP value for Value mode. For percentage, enter "10" for 10%, not "0.10".</li>
                                <li><strong>Reference Price:</strong> Which price to monitor:
                                    <ul style="margin-top: 4px; margin-left: 16px;">
                                        <li><em>High (Instant Buy)</em> - The price you pay to buy instantly. Good for tracking buying opportunities.</li>
                                        <li><em>Low (Instant Sell)</em> - The price you receive when selling instantly. Good for tracking when to sell.</li>
                                        <li><em>Average</em> - The midpoint between high and low. Good for general price tracking.</li>
                                    </ul>
                                </li>
                                <li><strong>Minimum Price</strong> (when All Items selected): Only monitor items worth at least this much GP. Filters out low-value items.</li>
                                <li><strong>Maximum Price</strong> (when All Items selected): Only monitor items worth at most this much GP. Useful for staying within budget.</li>
                            </ul>
                        </div>
                        
                        <div class="alert-help-note" style="margin-top: 12px; padding: 10px; background: rgba(255, 193, 7, 0.1); border-radius: 6px; border-left: 3px solid #ffc107;">
                            <strong>ðŸ“Š Baseline Price:</strong> When you create a threshold alert, the system captures the current price as the "baseline".
                            All future comparisons are made against this baseline, not a rolling window. You can see the baseline price on the alert detail page.
                        </div>
                    </div>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                                <path fill-rule="evenodd"
                                    d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z"
                                    clip-rule="evenodd" />
                            </svg>
                            When To Use
                        </h4>
                        <ul>
                            <li>You bought an item and want to know when it rises/falls by a specific percentage</li>
                            <li>Monitoring portfolio items for significant price changes</li>
                            <li>Setting price-based exit or entry triggers</li>
                            <li>Tracking items with specific GP profit targets (single item, Value mode)</li>
                            <li>Scanning all items for significant market movements</li>
                        </ul>
                    </div>

                    <div class="alert-help-card">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                    clip-rule="evenodd" />
                            </svg>
                            Threshold vs Spike Alerts
                        </h4>
                        <p>Understanding when to use each:</p>
                        <ul>
                            <li><strong>Threshold:</strong> Uses a <em>fixed baseline</em> (price when created). Good for "notify me when this item is 10% higher than when I bought it".</li>
                            <li><strong>Spike:</strong> Uses a <em>rolling time window</em>. Good for "notify me when this item moves 10% in the last hour". Resets continuously.</li>
                        </ul>
                    </div>

                    <div class="example-scenario">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path
                                    d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z" />
                            </svg>
                            Example Scenario
                        </h4>
                        <p>You just bought an Armadyl Godsword for 15M and want to sell when it goes up 15%. Create a threshold alert with
                            Direction "Up", Threshold Type "Percentage", Threshold "15", and Reference "High". When the high price rises 15%
                            above your baseline (to ~17.25M), you'll be notified to sell!</p>
                    </div>

                    <div class="recommended-values">
                        <h4>
                            <svg viewBox="0 0 20 20" fill="currentColor" width="18" height="18">
                                <path fill-rule="evenodd"
                                    d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd" />
                            </svg>
                            Recommended Starting Values
                        </h4>
                        <div class="value-grid">
                            <div class="recommended-value">
                                <div class="label">Threshold Type</div>
                                <div class="value">Percentage (more flexible)</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Threshold</div>
                                <div class="value">5-15% for most items</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Direction</div>
                                <div class="value">Up (for selling) / Down (for buying)</div>
                            </div>
                            <div class="recommended-value">
                                <div class="label">Reference Price</div>
                                <div class="value">High for selling, Low for buying</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- =============================================================================
     PERFORMANCE: Scripts loaded with defer to not block initial render
     ============================================================================= -->
<!-- defer: Scripts execute after HTML parsing, in order, without blocking render -->
<script defer src="{% static 'js/alerts-config.js' %}"></script>
<script defer src="{% static 'js/alerts-state.js' %}"></script>
<script defer src="{% static 'js/alerts-api.js' %}"></script>
<script defer src="{% static 'js/alerts-ui.js' %}"></script>
<script defer src="{% static 'js/alerts-managers.js' %}"></script>
<script defer src="{% static 'js/alerts-actions.js' %}"></script>
<script defer src="{% static 'js/alerts-selectors.js' %}"></script>
<script defer src="{% static 'js/alerts-item-collections.js' %}"></script>
<script defer src="{% static 'js/alerts-init.js' %}"></script>
<script defer src="{% static 'js/alerts-help.js' %}"></script>
{% endblock %}
